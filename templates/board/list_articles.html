{% extends 'board/base.html' %}

{% block title %} {{ board.name }} {% endblock %}

{% block content %}
<h1>{{ board.name }}</h1>
{% if articles %}
<div class="accordion mt-2" id="accordion">
    {% for article in articles %}
    <div class="card">
        <div class="card-header" id="heading{{ forloop.counter }}">
            <div class="mb-0">
                <a class="text-body" role="button"
                   data-toggle="collapse" href="#collapse{{ forloop.counter }}"
                   aria-expanded="true" aria-controls="collapse{{ forloop.counter }}">
                    <div class="row">
                        <div class="col-8">
                            <span class="font-weight-bold">{{ article.subject }}</span>
                            {% if article.tag %}
                            <span class="badge badge-{{ article.tag.color }}">
                                {{ article.tag.name }}
                            </span>
                            {% endif %}
                        </div>
                        <div class="col-sm-4">
                                <span class="float-right text-muted">{{ article.updated_at | date:'Y-m-d H:i' }}</span>
                        </div>      
                    </div>
                </a>
            </div>    
        </div>
        <div id="collapse{{ forloop.counter }}" class="collapse {% if forloop.counter == 1 %}show{% endif %}"
             data-parent="#accordion"
             aria-labelledby="heading{{ forloop.counter }}">
            <div class="card-body">
                <p class="card-text">{{ article.body | linebreaksbr }}</p>
                {% if board.owner == user %}
                <form method="POST" action="{% url 'archive_article' user.username board.id article.id %}">
                    {% csrf_token %}
                <a class="card-link btn btn-outline-primary" href="{% url 'edit_article' user.username board.id article.id %}" role="button" >
                    編集
                </a>
                <input class="btn btn-primary card-link" type="submit" value="非表示">
                </form>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
</div>

{% else %}
<p class="mt-3">連絡事項はありません。This is fine☕</p>
{% endif %}

{% endblock content %}
